
<!-- <ng-template #messageTemplateRef let-message="message">
  <nz-comment [nzAuthor]="message.title"
              [nzDatetime]="formatDistanceTime(message.createdAt)"
              style="width: 40vw">
    <nz-avatar nz-comment-avatar nzIcon="user"
               [nzSrc]="message?.sender?.avatar">
    </nz-avatar>

    <nz-comment-content>
      <p>{{ message.content }}</p>
    </nz-comment-content>

    <nz-comment-action>Trả lời</nz-comment-action>

    <ng-container *ngIf="message.children && message.children.length">
      <ng-template ngFor let-child [ngForOf]="message.children">
        <ng-template [ngTemplateOutlet]="messageTemplateRef"
                     [ngTemplateOutletContext]="{ message: child }">
        </ng-template>
      </ng-template>
    </ng-container>
  </nz-comment>
</ng-template> -->
<!-- <nz-list [nzDataSource]="data" [nzRenderItem]="item" [nzItemLayout]="'horizontal'">
  <ng-template #commentTemplateRef #item let-item="item">
      <nz-comment [nzAuthor]="item.author">
          <nz-avatar nz-comment-avatar nzIcon="user" [nzSrc]="item.avatar"></nz-avatar>
          <nz-comment-content>
            <p>{{ item.content }}</p>
          </nz-comment-content>
          <nz-comment-action>Reply to</nz-comment-action>
          <ng-container *ngIf="item.children && item.children.length">
            <ng-template ngFor let-child [ngForOf]="item.children">
              <ng-template [ngTemplateOutlet]="commentTemplateRef" [ngTemplateOutletContext]="{ item: child }"> </ng-template>
            </ng-template>
          </ng-container>
        </nz-comment>
  </ng-template>
</nz-list> -->

<nz-row>
  <nz-col>
    <nz-list *ngIf="data.length" [nzDataSource]="data" [nzRenderItem]="item" [nzItemLayout]="'horizontal'"  [style]="{'padding': '5px', 'margin-right': '0px'}">
      <ng-template #item let-item>
        <ng-template #messageTemplateRef let-comment="comment">
          <nz-comment [nzAuthor]="comment.author">
            <!-- <nz-avatar nz-comment-avatar nzIcon="user" [nzSrc]="comment.avatar"></nz-avatar>          [style]="comment?.avatar ? '' : 'background-color: ' + getColor(member?.userId)" 
                                 [nzSrc]="member?.avatar" -->
            <nz-avatar nz-comment-avatar [nzText]="comment.author" nzIcon="user"></nz-avatar>
            <nz-comment-content>
              <p>{{ comment.content }}</p>
            </nz-comment-content>
            <!-- <nz-comment-action>Reply to</nz-comment-action> -->
            <ng-container *ngIf="comment.children && comment.children.length">
              <ng-template ngFor let-child [ngForOf]="comment.children">
                <ng-template [ngTemplateOutlet]="messageTemplateRef" [ngTemplateOutletContext]="{ comment: child }"> </ng-template>
              </ng-template>
            </ng-container>
          </nz-comment>
        </ng-template>
    
        <ng-template [ngTemplateOutlet]="messageTemplateRef" [ngTemplateOutletContext]="{ comment: item}"> </ng-template>
      </ng-template>
    </nz-list>
  </nz-col>
  <nz-col class="message-input-container" nzSpan="24">
    <form nz-form [formGroup]="formGroup" (ngSubmit)="onSubmit()" autocomplete="off">
      <nz-input-group [nzSuffix]="suffixIconSearch" nzSize="large">
        <input type="text" nz-input name="message" id="message" formControlName="message"
               placeholder="Nhập tin nhắn ..."/>
      </nz-input-group>
      <ng-template #suffixIconSearch>
        <nz-space>
          <nz-space-item>
            <a nz-button nzType="link">
              <i nz-icon nzType="link" nzTheme="outline"></i>
            </a>
          </nz-space-item>
          <nz-space-item>
            <a nz-button nzType="link">
              <i nz-icon nzType="send" nzTheme="outline"></i>
            </a>
          </nz-space-item>
        </nz-space>
      </ng-template>
    </form>
  </nz-col>
</nz-row>
